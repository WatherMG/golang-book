# 10.7.2. Загрузка пакетов

При использовании инструмента `go` путь импорта пакета указывает не только, где его найти в локальной рабочей области,
но и где его найти в Интернете, так что `go get` позволяет его получить и обновить.

Команда `go get` может загрузить один пакет или все поддерево, или репозиторий с помощью записи `...`, как в предыдущем
разделе. Инструмент `go` также **вычисляет и загружает все зависимости исходных пакетов**; именно поэтому в рабочей
области в предыдущем примере появился пакет `golang.org/x/net/html`.

После того как `go get` загрузит пакеты, он их **строит, а затем устанавливает библиотеки и команды**. Детальнее мы
рассмотрим этот вопрос в следующем разделе, но на приведенном далее примере видно, насколько простой этот процесс.
Первая приведенная ниже команда получает инструмент `golint`, который проверяет наличие распространенных проблем стиля в
исходном коде Go. Вторая команда запускает `golint` для `gopl.io/ch2/popcount` из раздела 2.6.2. Она услужливо сообщает,
что мы забыли написать документирующий комментарий для пакета:

``` shell
$ go get github.com/golang/lint/golint 
$ $GOPATH/bin/golint gopl.io/ch2/popcount 
src/gopl.io/ch2/popcount/main.go:1:1: 
	package comment should be of the form "Package popcount ..."
```

Команда `go get` поддерживает популярные сайты хостинга кода, такие как `GitHub`, `Bitbucket` и `Launchpad`, и может
делать соответствующие запросы в их системы управления версиями. Для менее известных сайтов, возможно, в пути импорта
придется указать, какой протокол контроля версий следует использовать, такой, как `Git` или как `Mercurial`. Подробную
информацию можно получить с помощью команды `go help importpath`.

Каталоги, которые создает `go get`, являются истинными клиентами удаленного хранилища, а не просто копиями файлов,
поэтому вы можете использовать команды управления версиями для просмотра внесенных вами локальных изменений или
выполнить обновление до другой версии. Например, каталог `golang.org/x/net` является клиентом `Git`:

``` shell
$ cd $GOPATH/src/golang.org/x/net 
$ git remote -v
origin https://go.googlesource.com/net (fetch) 
origin https://go.googlesource.com/net (push)
```

Обратите внимание на то, что имя домена в пути импорта пакета, `golang.org`, отличается от фактического имени домена
сервера `Git`, `go.googlesource.com`. Это особенность инструмента `go`, которая позволяет пакетам применять
пользовательское доменное имя в своих путях импорта при том, что размещены они в общей службе, такой
как `googlesource.com` или `github.com`. HTML-страницы по адресу https://golang.org/x/net/html включают показанные ниже
метаданные, которые перенаправляют инструмент `go` в `Git-репозиторий` на фактический сайт хостинга:

``` shell
$ go build gopl.io/ch1/fetch
$ ./fetch https://golang.org/x/net/html | grep goimport 
<meta name="goimport"
	content="golang.org/x/net git https://go.googlesource.com/net">
```

Если указан флаг `-u`, `go get` гарантирует, что все посещенные пакеты, включая зависимости, обновятся до последней
версии, **прежде чем будут выполнены сборка и установка**. Без этого флага пакеты, уже имеющиеся локально, **обновляться
не будут**. Команда `go get -u`, как правило, извлекает **последнюю версию каждого пакета**, что очень удобно, когда вы
начинаете работу, но может не подходить для развернутых проектов, в которых решающее значение имеет точный контроль
зависимостей. Обычное решение этой проблемы заключается в `поставщике кода`, т.е. в том, чтобы сделать неизменяемую
локальную копию всех необходимых зависимостей и обновлять ее очень осторожно и обдуманно. До Go 1.5 это требовало
изменения путей импорта таких пакетов, так что наша копия `golang.org/x/net/html` превращалась
в `gopl.io/vendor/golang.org/x/net/html`. Более поздние версии инструмента `go` поддерживают поставку непосредственно,
хотя здесь у нас нет места, чтобы показать подробности. (См. Vendor Directories в выводе команды go help gopath.)

Начиная с версии Go 1.6, поддерживается использование локальных копий внешних зависимостей, что называется
`"вендоризация"`. Это значит, что вы можете хранить зависимости вашего проекта в каталоге с именем `"vendor"` внутри
вашего проекта.

`Вендоризация` упрощает управление зависимостями, т.к. они будут храниться и импортироваться локально. Код в каталогах
`"vendor"` имеет приоритет над кодом в других каталогах, что позволяет легко использовать разные версии библиотек для
разных проектов.

Команда `'go get'` будет обновлять и зависимые репозитории, включая подмодули, но `вендоризация` не влияет на размещение
новых репозиториев, которые будут проверяться этой командой. Новые репозитории будут помещены в основной `GOPATH`, а не
в поддерево `"vendor"`.

## Выводы:

* Команда `go get` позволяет загрузить и обновить пакеты из Интернета, а также их зависимости; это упрощает управление
  кодом и синхронизацию с другими разработчиками;
* `go get` может загружать как одиночные пакеты, так и всё поддерево репозитория, что делает его универсальным
  инструментом;
* После загрузки пакетов команда `go get` автоматически выполняет сборку и установку библиотек и команд, что облегчает
  работу с новыми пакетами;
* Команда `go get` поддерживает популярные системы управления версиями, такие как Git или Mercurial, и популярные сайты
  хостинга кода, такие как GitHub, Bitbucket и Launchpad;
* Путь импорта указывает не только, где найти пакет в локальной рабочей области, но и где его найти в Интернете, что
  позволяет `go get` обрабатывать различные доменные имена и пути импорта;
* Если указан флаг `-u`, `go get` будет обновлять все посещенные пакеты и их зависимости до последней версии, что
  гарантирует их актуальность;
* Начиная с версии Go 1.6, поддерживается `"вендоризация"` – использование локальных копий внешних зависимостей, которые
  хранятся в каталоге `"vendor"` внутри проекта для легкого доступа и управления;
* `Вендоризация` упрощает управление зависимостями, т.к. зависимости разных проектов могут иметь разные версии и будут
  храниться локально, что позволяет легко переключать версии и избегать конфликтов.