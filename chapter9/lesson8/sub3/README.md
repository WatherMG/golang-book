# 9.8.3 GOMAXPROCS

`Планировщик Go` использует параметр с именем `GOMAXPROCS` для определения, **сколько потоков операционной системы могут
одновременно активно выполнять код Go**. Его значение по умолчанию **равно количеству процессоров компьютера**, так
что на машине с 8 процессорами планировщик будет планировать код Go для выполнения на **8 потоках одновременно**
(GOMAXPROCS равно значению n в m:n-планировании). Спящие или заблокированные в процессе коммуникации горутины
потоков для себя не требуют. Горутины, заблокированные в операции ввода-вывода или в других системных вызовах, или при
вызове функций, не являющихся функциями Go, нуждаются в потоке операционной системы, но GOMAXPROCS их не учитывает.

Можно явно управлять этим параметром с помощью переменной среды `GOMAXPROCS` или функции `runtime.GOMAXPROCS`. Мы можем
увидеть влияние `GOMAXPROCS` на следующем маленьком примере программы, которая выводит бесконечный поток нулей и единиц:

``` go
for {
	go fmt.Print(0)
	fmt.Print(1)
}
```

```shell
$ G0MAXPR0CS=1 go run hacker-cliche.go
111111111111111111110000000000000000000011111...

$ G0MAXPR0CS=2 go run hacker-cliche.go 
010101010101010101011001100101011010010100110...
```

При первом запуске одновременно выполняется не более одной горутины. Первоначально это главная горутина,
выводящая единицы. Спустя некоторое время планировщик приостанавливает ее и активирует горутину, выводящую нули,
выделяя ей время для работы в потоке операционной системы. При втором запуске имеются два потока операционной системы,
так что обе горутины работают одновременно, выводя цифры примерно с одной и той же скоростью. Мы должны
подчеркнуть, что в планировании горутин участвуют многие факторы, а среда выполнения постоянно развивается, так
что ваши результаты могут отличаться от приведенных выше.

## Выводы:

* Планировщик Go использует параметр `GOMAXPROCS` для определения **количества потоков операционной системы**, которые
  могут одновременно активно выполнять код Go; это позволяет оптимально распределить ресурсы процессора для
  одновременного выполнения задач;
* Значение `GOMAXPROCS` по умолчанию **равно количеству процессоров компьютера (логических)**, что обеспечивает
  оптимальное использование мощности машины для выполняемых программ;
* `Спящие`, `заблокированные в коммуникации` или `заблокированные на операциях ввода-вывода` горутины **не требуют самих
  потоков**, что снижает нагрузку на систему при работе с большим количеством горутин;
* Управление параметром `GOMAXPROCS` возможно через переменную среды или функцию `runtime.GOMAXPROCS`, что позволяет
  адаптировать его значение для конкретных условий и оптимизировать процессы в различных ситуациях;
* Изменение значения `GOMAXPROCS` может привести к изменению поведения программы, исходя из количества доступных потоков
  и одновременно работающих горутин; **это позволяет более точно контролировать процесс выполнения кода и рассчитывать
  заранее требуемые ресурсы системы**;
* Планирование горутин зависит от множества факторов и среды выполнения, что делает каждую ситуацию уникальной и может
  привести к различным результатам при разных условиях.
